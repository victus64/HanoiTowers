/! HanoiTower 22-03-2015 /
function InitCanvas(a){var b={};return b.canvas=document.getElementById(a),b.ctx=b.canvas.getContext("2d"),b.ctx.fillStyle="#FCFCF3",b.ctx.fillRect(0,0,b.canvas.width,b.canvas.height),b}function Start(){document.writeln("<p>Тут будут строиться Ханойские башенки!</p>");var a=new HanoiModel(8),b=new HanoiView(a,"HanoiTower");b.DrawAll()}function circle(a,b){b||(b=HVModel),this.vm=b,this.state="free",this.n=a;var c=b.canvas.width,d=b.canvas.height;this.h=0^d/2/Math.max(b.N,5),this.r=0^c/80+(b.N-a)*(c/7-c/80)/b.N,this.color=b.circleColors[a],this.ok=function(){return!(0>=this.n||this.n>b.N)},this.onStick=function(a,b){this.state="onStick",this.s=a,this.p=b;var c=this.vm.canvas.width,d=this.vm.canvas.height;return this.x=0^c/6*(2*a+1),this.y=d-this.h*(b+2),this.ok=function(){return!(0>=this.s||this.s>2||0>=this.p||this.p>this.vm.N||0>=this.n||this.n>this.vm.N)},this},this.Draw=function(){return"onStick"!=this.state?!1:(this.vm.ctx.fillStyle=this.color,this.vm.ctx.fillRect(this.x-this.r,this.y,2*this.r,this.h),!0)}}function HanoiView(a,b){var c=InitCanvas(b);this.canvas=c.canvas,this.ctx=c.ctx,this.model=a,this.N=a.N,this.circleColors=function(a){for(var b=[],c=0;a>c;c++)b[c]="#"+(0^200*Math.random()+16).toString(16)+(0^200*Math.random()+16).toString(16)+(0^200*Math.random()+16).toString(16);return b}(this.N),this.DrawCircle=function(a,b,c){return new circle(c,this).onStick(a,b).Draw()},this.DrawAll=function(){for(var a=0;a<this.model.Sticks.length;a++)for(var b=0;b<this.model.Sticks[a].length;b++)this.DrawCircle(a,b,this.model.Sticks[a][b])}}function HanoiModel(a){this.N=a,this.Sticks=[function(a){for(var b=[],c=0;a>c;c++)b.push(c);return b}(a),[],[]],this.MoveHead=function(a,b,c){a==this.Sticks[b].length-1&&this.Sticks[c].push(this.Sticks[b].pop())}}exports.home=function(a,b){b.send("Home page")};